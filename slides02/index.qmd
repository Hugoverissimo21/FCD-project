---
title: "Media Analysis of PSI-20 Companies"
subtitle: "Insights from News and Public Coverage"
author:
  - name: "Hugo Veríssimo"
    affiliation: "124348"
format:
  revealjs: 
    slide-number: true
    chalkboard: 
      buttons: false
    preview-links: auto
    logo: ua.png
    css: mystyle.css
    theme: serif
    transition: slide
echo: true
---

```{r setup, include = FALSE}
# packages
library(dplyr)
library(knitr)
library(xtable)
library(reticulate)
```

```{python, include=FALSE}
import pandas as pd
import requests
from bs4 import BeautifulSoup
import time
from datetime import datetime
```

## lembretes {.justify}

- meter codigo dos graficos?: NAO

$\ $

- texto justificado

- tudo em ingles

- tlvz fazer ponte de onde se ficou no trabalho 1 para agora ?

## data04.parquet

data before

# NER and Sentiment Analysis

## NER

- used spacy and "pt_core_news_sm" to extract {"PER", "ORG", "LOC", "MISC"} and also {NOUN}

- i had to define some words and rules to filter out expressoes/palvras inuteis ou erros de extracao por parte da biblioteca spacy

link to file 04_nerandsent

## Sentiment Analysis

- used vaderSentiment (SentimentIntensityAnalyzer), from textblob import TextBlob and from deep_translator import GoogleTranslator, because it was not working for portuguse text, so i decided it would be easy to translate and then do the analysis e pq:

- - pipeline nunca dava, muito complicado

- - estes dois so dao em ingles e um tem mt em conta os factos, tp terrorimos etc, outro tem os sentimentos de qm fala, ent mais vale fazer uma média

- i beleive it wont have much impact , since what matters are some strong keywords which the translate wont have much impact

link to file 04_nerandsent

## data05.parquet

new data

- coluna news agr tem uma componente no dicionario de sentimentos para cada noticia e todas as palavras extraidas categorizadas ({"PER", "ORG", "LOC", "MISC", NOUN})

- coluna keywords é um dicionario com a contagem de palavras por exempresa, sentimento referente à mesma, tipo de categorias onde foi vista, contagem das datas onde foi vista, contagem da source

# Visualizations

## News Sources

```{=html}
<figure style="text-align: center;">
    <img src="newsSources.svg" alt="noticias por fonte" style="width: 100%;">
    <figcaption style="font-size: 0.45em; margin-top: -25px; margin-bottom: 25px;">Fig. x: Descricao bla bla.</figcaption>
</figure>
```

link para **newsSources v01.ipynb**

apesar de ter usado 30 sites, a maioria so tem noticias pós 2020, e alguns n têm respostas de todo


## Word Cloud

```{=html}
<figure style="text-align: center;">
    <img src="wordcloud bcp.svg" alt="wordcloud bcp" style="width: 100%;">
    <figcaption style="font-size: 0.45em; margin-top: -25px; margin-bottom: 25px;">Fig. x: Descricao bla bla.</figcaption>
</figure>
```

feito com **compWordcloud v01.ipynb**, tendo por base as palavras mais mencionadas

## Word Cloud

```{=html}
<figure style="text-align: center; display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
  <img src="wordcloud galp.svg" alt="wordcloud galp" style="width: 100%;">
  <img src="wordcloud edp.svg" alt="wordcloud galp" style="width: 100%;">
  <img src="wordcloud sonae.svg" alt="wordcloud galp" style="width: 100%;">
  <img src="wordcloud motaengil.svg" alt="wordcloud galp" style="width: 100%;">
</figure>
```


## preço acoes e sentimentos/qnt news

```{=html}
<figure style="display: flex; flex-direction: column; align-items: center; gap: 5px;">
  <div style="display: flex; flex-direction: row; gap: 5px;">
    <img src="newsVSsenti01.svg" alt="Image 1" style="width: 50%;" />
    <img src="newsVSsenti04.svg" alt="Image 2" style="width: 50%;" />
  </div>
  <figcaption style="font-size: 0.45em; margin-top: -25px; margin-bottom: 25px text-align: center;">GALP.LS, Galp Energia</figcaption>
</figure>
```

info = {1: "media dos sentimentos do mes",
        4: "mes se é positivo ou negativo",
        #5: "log da soma dos sentimentos do mes, pq Redução de Disparidades Extremas, Linearização da Relação",
        #6: "número de notícias do mês",
        #7: "número de notícias do mês, diferenciado",
        #8: "número de notícias do mês e varicao do preco em abs",
        #10: "numero de noticias do mes, mas em log",
        #11: "número de notícias do mês, diferenciado e em log",
        #12: "número de notícias do mês, diferenciado e dif de precos em exp",
        #13: "número de notícias do mês, diferenciado e em log",
        #14: "número de notícias do mês, diferenciado e dif de precos em %"
        }
        
- a meu ver, e de acordo com os coef de correlacao, n ha nenhuma corr entre qnt de noticias e variacao do preco...

- simplesmente n existe

- fiz mal os sentimentos

- tnh noticias irrelevantes


feito com **newsVSstock v03**

## next

aa
